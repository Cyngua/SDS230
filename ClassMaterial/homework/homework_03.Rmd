---
title: "Homework 3"
output:
  pdf_document: default
  html_document:
    df_print: paged
---




$\\$





The purpose of this homework is to practice using randomization methods to run hypothesis tests. Please fill in the appropriate code and write answers to all questions in the answer sections, then submit a compiled pdf with your answers through Gradescope by 11pm on Sunday September 26th. 

As always, if you need help with the homework, please attend the TA office hours which are listed on Canvas and/or ask questions on [Ed Discussions](https://edstem.org/us/courses/12764/discussion/). Also, if you have completed the homework, please help others out by answering questions on Ed Discussions which will count toward your class participation grade.




<!--  Please run the code in the  R chunk below once. This will install some packages and download data needed for these exercises.  -->

```{r message=FALSE, warning = FALSE, echo = FALSE, eval = FALSE}

SDS230::download_image("lawyer.png")
SDS230::download_image("diamonds_forever.jpg")
SDS230::download_image("diamonds_pressure.jpg")

SDS230::download_data("amazon.rda")
SDS230::download_image("correlation.png")

```





<!-- The R chunk below sets some parameters that will be used in the rest of the document. Please ignore it and do not modify it. -->
```{r options, message=FALSE, warning=FALSE, tidy=TRUE, echo = FALSE}

library(knitr)
#library(latex2exp)

options(scipen=999)

opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE)
set.seed(230)  # set the random number generator to always give the same random numbers
    
```





$\\$






## Part 1: Are lawyers more sinister than the typical US adults? 


Lawyers often have a bad reputation, but is it the case that lawyers are more sinister than the typical US adults? Let's investigate!

It is known that 10% of US adults are left-handed (i.e., are sinister). A study took a random sample of 105 lawyers and found that 16 were left-handed. Does this provide evidence that a higher proportion of lawyers are left-handed compared to the US population? Please complete the 5 steps of hypothesis testing below to examine this question.






$\\$





**Part 1.1 (4 points)**: State the null and alternative hypotheses for testing whether a higher percentage of lawyers are left-handed compared to the general US population using both words and in the appropriate symbols. Also describe what the term 'significance level' means, and denote it with the commonly used symbol and commonly used threshold value. Finally, please state whether this study is an observational study or an experiment and why.



**Answer**: 









$\\$






**Part 1.2 (4 points)**: Compute the statistic of interest and save it in an object `lawyer_stat`. Based on just looking at this statistic, would you guess that lawyers are left-handed at a higher rate than the US population? 

```{r part_1_2}
  



  
    
```


**Answer**: 







$\\$






**Part 1.3 (6 points)**: Now use the `rbinom()` function to generate a null distribution that would be expected if the null hypothesis was true, and save this in an object called `null_distribution`. 

Remember that the arguments to `rbinom(num_sims, size, prob)` are: 

 * `num_sims`: the number of simulations to run
 * `size`:  the number of "coin flips" in each simulation
 * `prob`:  the probability of getting heads on each coin flip. 

Also plot the null distribution as a histogram showing the proportion of "heads" (i.e., proportion of lawyers that are left-handed), and add a vertical line at the observed statistic.

```{r part_1_3}

  





 
    
        
```







$\\$







**Part 1.4 (4 points)**: Now use the `null_distribution` and the `lawyer_stat` objects to calculate the number of simulations that had a proportion of heads as high or higher than the observed statistic. Convert this to a p-value by dividing by the total number of simulations. Describe whether this p-value provides sufficient evidence that lawyers are more left-handed than the general US population.  

```{r part_1_4}
    

    

    

        
```

**Answer**: 






$\\$






**Part 1.5 (12 points)**: Calculate a 95% confidence interval for the proportion of lawyers that are left-handed using the bootstrap. Hint: You will need to create a vector of actual data to do the bootstrap. Using the `rep("left", 16)` as part of the process for creating this vector is a good way to go, and then also consider how many "right"'s you would have. 

```{r part_2_5}
    

  





















   
```


**Answer**: 








$\\$








**Part 1.6 (5 points)**: There is also a formula for calculating the standard error of a proportion which is:

$s_p = \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}$


Use this formula to create 95% confidence intervals and compare it to the 95% confidence intervals you calculated in the previous problem. Describe in the answer section below whether the two methods for calculating confidence intervals lead to similar results.


```{r part_1_6}






```


**Answer** 






![](lawyer.png)






$\\$






## Part 2: Do diamond prices differ depending on the quality of the cut? 


In 2018, the total global wholesale value of polished diamonds amounted to almost [25.3 billion U.S. dollars](https://www.statista.com/statistics/612251/wholesale-value-of-polished-diamonds-worldwide/). The price of an individual diamond can be affected by several factors including the diamond's color, clarity, size and the quality of how it was cut. In this exercise, we will examine data from a large set of diamonds to assess whether the quality of the cut of a diamond affects the average price. 



$\\$




**Part 2.0 (4 points)** 

The code below loads a data frame called `diamonds` that comes from the ggplot2 package, which is a package that is used to visualize data (we will discuss this package soon). For more information about the data set see [this website](https://ggplot2.tidyverse.org/reference/diamonds.html). 

In the exercises below we will compare the mean price of diamonds, for two different levels of the diamond's cut. The levels of cut we are going to compare are the `Fair` cut diamonds (which is the worst cut), and the `Ideal` cut diamonds, which is the best cut. To start this analysis, create a object called `fair_price` that contains the prices for all the diamonds corresponding to the `Fair` cut, and a vector object called `ideal_price` that contains the prices for all the diamonds corresponding to the `Ideal` cut. If done correctly, the `fair_price` vector should have 1,610 elements, and the `ideal_price` vector should have 21,551 elements in it. Also report in the answer section below, how many cases and variables the full `diamonds` data frame has (the `dim()` function can help with this) and also whether you think the prices for the `Ideal` cut diamonds will be higher than the prices for `Fair` cut diamonds. Finally, please state whether this study is an observational study or an experiment and why. 



```{r diamond_data}

library(ggplot2)
data(diamonds)







```


**Answer**: 







$\\$





In parts 2.1 to 2.5 you will now do the 5 steps to run a hypothesis test!



$\\$




**Part 2.1 (5 points)** Let's start our hypothesis testing in the usual way by stating the null and alternative hypotheses using words and symbols. Although you might have a prior expectation that one of the diamonds cuts will have a higher average price than the other, please state the alternative hypothesis in a non-directional way such that you are testing whether the average prices of the `Fair` cut and `Ideal` are different, not that one price is higher than the other. When running your hypothesis test below, also do the analysis in such a way that you are doing a non-directional test (i.e., you will calculate the p-value by looking at both tails of the distribution).

Finally, write down the significance level using the appropriate symbol, and set it to the most commonly used value. 



**Answer**:  








$\\$









**Part 2.2 (4 points)**  Now calculate the value of that observed statistic that is appropriate for this analysis. In the answer section write down the value for this statistic and use the appropriate notation to denote this statistic. Also visualize the data by creating a side-by-side box plot comparing the two groups. Based on this plot, describe in the answer section whether you believe there is a difference in mean prices.


```{r diamonds_stat}

 






```

**Answer**:  







$\\$







**Part 2.3 (12 points)**  Now create a null distribution using a permutation test. To do this, combine data from both groups, randomly assign the data to a fake "fair" and "ideal" groups, calculate a null statistic, and repeat 10,000 times to get a null distribution. Also plot a histogram of the null distribution and add a red vertical line to the plot at the value of the observed statistic. Based on this plot, do you think the average diamond price is the same between the two cuts? 


```{r diamonds_null}






















```


**Answer** 






$\\$






**Part 2.4 (5 points)** Now calculate the p-value in the R chunk below. Be sure that you calculate the p-value using both tails (which should be consistent with how you stated the null hypothesis). Is this the p-value you would expect based on the plot of the null distribution and observed statistic in part 2.3? 

```{r diamonds_pvalue}








```


**Answer** 







$\\$







**Part 2.5 (4 points)** Are the results statistically significant? Do you believe there is a difference between these groups? Are these results surprising at all? 



**Answers**:  








$\\$




**Part 2.6 (5 points) Challenge problem** 


**This is a "challenge problem" that you should try to figure out without getting help from the TAs. Challenges problems might be more difficult than other problems but they won't be worth too many points, so they will not have a large impact on your homework score.**


From looking at the observed statistic, we notice that the fair cut diamonds actually have a higher price than the ideal cut diamond! This is strange since one would expect diamonds that have a better cut would cost more. Try examining the full diamonds data frame and see if you can come up with a reason why it might be the case that fair cut diamonds cost more. 

Once you have identified another reason why the prices might be higher for the fair cut diamonds, create a plot that gives evidence that your explanation makes sense, and describe in the answer section below what is causing these strange results. Hint: use boxplots, scatterplots and/or other types of plots you see fit to explain the price difference.


```{r challenge}










```



**Answers**: 








$\\$





![](diamonds_pressure.jpg)


$\\$



 
## Part 3: A permutation test for the correlation coefficient 

In class (and on this homework) we have used randomization methods and a 5 step process to run hypothesis tests for comparing whether a population proportion is equal to a particular value, and whether two population means are the same. We can use randomization methods and similar logic to run hypothesis tests on other parameters as well. In this exercise, you will come up with a hypothesis test for testing whether two variables are correlated. 

As you hopefully remember from introductory statistics, the correlation coefficient measures the strength of a linear association between two quantitative variables, where a value of |1| means there is a perfect linear association, and a value of 0 means there is not a linear association between the variables. The symbol that is typically used to denote the population correlation (i.e., if there were infinite pairs of data points) is denoted with $\rho$, and the correlation value calculated on a sample is denoted with the symbol $r$. 

In the problem below, we will examine a sample of books purchased on Amazon.com to assess whether there is a linear association between the number of pages in a book and the price of the book. As you can imagine, ink and paper costs money, so longer books might be more expensive. Then again, the real value is in the words themselves, so perhaps there is not a relationship? Let's investigate this question!





$\\$





**Part 3.1 (4 points)**: As always when running hypothesis tests, start by stating the null and alternative hypotheses, and the significance level, using both words and using the appropriate symbols. 



**Answer**:  







$\\$





**Part 3.2 (5 points)**: The code below loads a data frame with information on 230 paperback books listed on Amazon that sell for under $60. Create a vector called `num_pages` that has the number of pages in each book, and a vector called `price` that has the price of each book. Then create a scatter plot of the data. Also, calculate the statistic of interest using the `cor()` function, save it to an object called `obs_stat`, and print it. Does the statistic value have the sign that you would expect? Based on the magnitude of the statistic value do you think there will be a statistically significant relationship between the number of pages in a book and its price? 


```{r amazon_data}

load("amazon.rda")











```

**Answer**:  





$\\$






**Part 3.3a (3 points)**: Step 3 of the 5 step hypothesis testing procedure is to calculate the null distribution. When trying to figure out how to create a null distribution for a new statistic, a useful first step is just to calculate *one* statistic value that is consistent with the null hypothesis. Let's take this step now by calculating one statistic value that is consistent with the null hypothesis. 

Hint: if we have a vector called `my_vec`, then the `sample(my_vec)` function will randomly reorder the elements in the vector. 


```{r one_null_stat}



```




$\\$





**Part 3.3b (5 points)**: Now that you have one statistic value consistent with the null distribution, go ahead and create the full null distribution. Then plot it as a histogram and put a red vertical line at the value of the observed statistic. Based on this plot, do you think the results will be statistically significant? 


```{r amazon_null_dist}





```

**Answer**: 





$\\$





**Part 3.4 (3 points)**: Now calculate the p-value and print out the value.   



```{r amazon_pvalue}



```







$\\$







**Part 3.5 (3 points)** Report whether the results are statistically significant and what your conclusions are. 



**Answer**: 





$\\$



![](correlation.png)


$\\$



## Reflection (3 points)


Please reflect on how the homework went by going to Canvas, going to the Quizzes link, and clicking on [Reflection on homework 3](https://yale.instructure.com/courses/68751/quizzes/40877)





